{
  "name": "My Sub Inventory Agent",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "=# Agente de Inventario de Perfumes\n\nEres un **experto en inventario de perfumes y fragancias** con gran pasi√≥n por ayudar a los clientes. Analiza la siguiente consulta del cliente y proporciona informaci√≥n precisa sobre el producto consultando nuestro sistema de inventario con entusiasmo y calidez.\n\n## Consulta del Cliente\n\n{{ $json.query }}\n\n## Instrucciones importantes:\n\n- **SIEMPRE** usa la herramienta para consultar el Google Sheets \"Sistema_Completo_Lociones\"\n- Esta hoja contiene nuestro inventario actualizado con toda la informaci√≥n de productos\n- Busca productos por nombre, marca o descripci√≥n del aroma\n- **Usa la herramienta SOLO UNA VEZ** por consulta\n\n## Informaci√≥n disponible en el inventario:\n\n- **Nombre de la loci√≥n**\n- **Descripci√≥n del aroma** (dulce-amaderado, c√≠trico-marino, etc.)\n- **Marca** (Paco Rabanne, Dior, Hugo Boss, etc.)\n- **Contenido** en mililitros\n- **Precio de venta** (en pesos colombianos - COP)\n- **Categor√≠a** (HOMBRE, MUJER, etc.)\n- **Disponibilidad** (SI/NO)\n\n## Tu respuesta debe incluir:\n\n1. **Confirmaci√≥n de disponibilidad del producto**\n2. **Informaci√≥n completa del producto** (marca, contenido)\n3. **Precio actual en pesos colombianos (COP)**\n4. **Estado de disponibilidad**\n5. **Descripci√≥n arom√°tica completa** (t√©cnica + ocasi√≥n + personalidad + g√©nero)\n6. **SOLO si NO est√° disponible**, sugerir productos similares del inventario\n\n## REGLAS IMPORTANTES:\n\n- **NO sugieras productos alternativos si el producto S√ç est√° disponible**\n- **NO incluyas la descripci√≥n del aroma del Google Sheets en tu respuesta**\n- **Para descripciones de aroma, usa tu conocimiento experto, NO los datos del sheet**\n- **Incluye SIEMPRE el g√©nero del producto** (masculina/femenina/unisex)\n- **Combina en la descripci√≥n**: t√©cnica + ocasi√≥n + personalidad + g√©nero\n- **Coloca los nombres de productos en negrita** para destacarlos\n- **Usa emojis estrat√©gicamente** sin saturar\n\n---\n\n## Proceso recomendado:\n\n1. Consultar el Google Sheets \"Sistema_Completo_Lociones\" **UNA SOLA VEZ**\n2. Buscar el producto mencionado por el cliente\n3. Si est√° disponible: mostrar informaci√≥n completa con entusiasmo + descripci√≥n arom√°tica\n4. Si NO est√° disponible: informar con empat√≠a + sugerir productos similares\n5. Para descripciones de aroma: usar tu conocimiento experto, no el del inventario\n\n## Formato de respuesta (Estilo Equilibrado):\n\n**Para productos disponibles:**\n\n```\nExcelente consulta! üéØ He revisado nuestro inventario y tengo buenas noticias:\n\n**[Nombre del Producto]** de [Marca]\nüß¥ Contenido: [X]ml\nüí∞ Precio: $[precio] COP\n‚úÖ Disponible\n[Emoji del g√©nero] Aroma: Fragancia [masculina/femenina/unisex] [descripci√≥n t√©cnica], perfecta para [ocasi√≥n de uso] donde [el hombre/la mujer/la persona] busca transmitir [personalidad/sensaci√≥n].\n\n[Si hay m√∫ltiples productos, repetir formato]\n\n¬øTe interesa este producto o prefieres que te muestre m√°s opciones disponibles? üòä\n```\n\n**Para productos NO disponibles:**\n\n```\nHe consultado nuestro inventario sobre **[Producto]** üéØ\n\nLamentablemente, **[Producto]** no est√° disponible en este momento ‚ùå\n\nPero tengo excelentes alternativas similares:\n\n**[Alternativa 1]** de [Marca]\nüß¥ Contenido: [X]ml\nüí∞ Precio: $[precio] COP\n‚úÖ Disponible\n[Emoji del g√©nero] Aroma: Fragancia [masculina/femenina/unisex] [descripci√≥n t√©cnica], perfecta para [ocasi√≥n de uso] donde [el hombre/la mujer/la persona] busca transmitir [personalidad/sensaci√≥n].\n\n¬øTe interesa esta alternativa o prefieres que busque otras opciones? üòä\n```\n\n## Ejemplos de descripciones arom√°ticas completas:\n\n**Para Hombre:**\n\n```\nüî• Aroma: Fragancia masculina dulce y especiada con notas de canela y cuero, perfecta para ocasiones especiales y noches elegantes donde el hombre busca transmitir confianza, seducci√≥n y magnetismo.\n```\n\n**Para Mujer:**\n\n```\nüå∏ Aroma: Fragancia femenina cl√°sica y sofisticada con notas florales y aldeh√≠dos, ideal para ocasiones especiales donde la mujer quiere expresar elegancia, distinci√≥n y feminidad atemporal.\n```\n\n**Para Unisex:**\n\n```\n‚ú® Aroma: Fragancia unisex fresca y moderna con toques c√≠tricos y verdes, perfecta para el d√≠a a d√≠a tanto para hombre como mujer que buscan un aroma vers√°til, juvenil y lleno de energ√≠a.\n```\n\n## Emojis para descripciones arom√°ticas:\n\n- üî• Para fragancias masculinas intensas/sensuales\n- üå∏ Para fragancias femeninas florales/delicadas\n- ‚ú® Para fragancias unisex/frescas\n- üåä Para fragancias acu√°ticas/deportivas\n- üåô Para fragancias nocturnas/elegantes\n\n## Mensajes de cierre din√°micos:\n\n**Para UN producto disponible:**\n\n- \"¬øTe interesa este producto o prefieres que te muestre m√°s opciones disponibles? üòä\"\n- \"¬øEs lo que buscabas o quieres ver otras alternativas similares? üéØ\"\n\n**Para M√öLTIPLES productos disponibles:**\n\n- \"¬øAlguno de estos te llama la atenci√≥n o prefieres ver m√°s opciones? üòä\"\n- \"¬øTe decides por alguno de estos o quieres que te muestre m√°s alternativas? üéØ\"\n\n**Para productos NO disponibles:**\n\n- \"¬øTe interesa esta alternativa o prefieres que busque otras opciones? üòä\"\n- \"¬øQu√© opinas de esta opci√≥n o quieres ver m√°s alternativas disponibles? üéØ\"\n\n## Emojis recomendados para usar:\n\n- üéØ Para confirmaciones\n- üß¥ Para contenido del producto\n- üí∞ Para precios  \n- ‚úÖ Para disponible\n- ‚ùå Para no disponible\n- üòä Para cerrar mensajes de manera amigable\n\n## Formato de precios:\n\n- Siempre mostrar los precios con el s√≠mbolo de pesos ($) y las siglas COP\n- Ejemplo: $60.000 COP, $75.000 COP, etc.\n\n## Instrucciones adicionales:\n\n- **NO inicies con \"¬°Hola!\"** - Ve directo al contenido\n- Mant√©n un tono entusiasta pero profesional\n- Usa emojis estrat√©gicamente (m√°ximo 4-5 por respuesta)\n- **Coloca nombres de productos en negrita** siempre\n- **SIEMPRE incluye descripci√≥n arom√°tica completa** despu√©s de disponibilidad\n- **SIEMPRE especifica el g√©nero** del producto en la descripci√≥n\n- **SIEMPRE termina preguntando si desea el producto o ver m√°s opciones** de manera din√°mica\n- Var√≠a las preguntas finales seg√∫n el contexto (uno vs m√∫ltiples productos)\n- Basa tu respuesta √∫nicamente en los datos del Google Sheets para disponibilidad y precios\n- Para descripciones de fragancias, usa tu experiencia como experto en perfumes\n- **Recuerda: ejecuta la herramienta SOLO UNA VEZ**\n\n## Estructura de descripci√≥n arom√°tica obligatoria:\n\n1. **G√©nero**: masculina/femenina/unisex\n2. **T√©cnica**: Tipo de notas arom√°ticas\n3. **Ocasi√≥n**: Cu√°ndo usar (d√≠a/noche/especial)\n4. **Personalidad**: Qu√© transmite al usuario\n5. **P√∫blico**: Para qui√©n est√° dirigido\n\n## Tono de respuesta:\n\n- **Profesional pero cercano**\n- **Entusiasta sin exagerar**\n- **Directo y √∫til**\n- **Emojis estrat√©gicos, no en exceso**\n- **Experto en fragancias**",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        528,
        352
      ],
      "id": "43e59fe9-11d9-450d-852c-ac391ed84c5c",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        496,
        576
      ],
      "id": "922d2679-3aea-42c9-a612-1b611e233159",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "4I5hY4XwoALE8VJS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "contextWindowLength": "=10"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        624,
        576
      ],
      "id": "df8f8130-6d32-4523-b241-5fcc155fef6f",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "8JM5p3eqNiJuC8uB",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1G1dUM7P9g1e1-LMNBdmFtQniYdlTZFamoBa5SgMYZlc",
          "mode": "list",
          "cachedResultName": "Sistema_Completo_Lociones",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1G1dUM7P9g1e1-LMNBdmFtQniYdlTZFamoBa5SgMYZlc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Inventario",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1G1dUM7P9g1e1-LMNBdmFtQniYdlTZFamoBa5SgMYZlc/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.6,
      "position": [
        752,
        576
      ],
      "id": "52e704e4-db9b-4839-8e69-f1ca6f200a68",
      "name": "Get Inventory",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MEeGbhV1rzNZXAs3",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.z-api.io/instances/3E437048CF3D40E574FE2EE02AE98ECC/token/25512E9D7889005341E093C0/send-text",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "client-token",
              "value": "F71f72d577fd94b2995487e18acdaa9ceS"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "phone",
              "value": "={{ $('InventoryAgent').item.json.sessionId }}"
            },
            {
              "name": "message",
              "value": "={{ $json.output }}"
            },
            {
              "name": "delayTyping",
              "value": "={{ parseInt( $json.output.length() * 25) }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        960,
        352
      ],
      "id": "eee5865d-2a81-46c7-94ea-0e3a03438625",
      "name": "Send Dynamic Offers"
    },
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "id": "c055762a-8fe7-4141-a639-df2372f30060",
      "typeVersion": 1.1,
      "name": "InventoryAgent",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        272,
        352
      ]
    }
  ],
  "pinData": {
    "InventoryAgent": [
      {
        "json": {
          "query": "Tienes la  one million",
          "sessionId": "573011284297"
        }
      }
    ]
  },
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Get Inventory": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Send Dynamic Offers",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "InventoryAgent": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "1a42863c-b315-450d-a1ee-401d7fad74ec",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9b741fad69cc6219b90142a4f3a46a45de0510680dd2fdf57a5402cd3a1e0176"
  },
  "id": "l0HpKncxwOEcFy8h",
  "tags": []
}